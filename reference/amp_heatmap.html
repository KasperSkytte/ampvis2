<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Heatmap — amp_heatmap • ampvis2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Heatmap — amp_heatmap"><meta property="og:description" content="Generates a heatmap of amplicon data by using sample metadata to aggregate samples and taxonomy to aggregate OTUs."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93913019-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93913019-2');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ampvis2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.7.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/ampvis2.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/faq.html">FAQ</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/MadsAlbertsen/ampvis2" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Heatmap</h1>
    <small class="dont-index">Source: <a href="https://github.com/MadsAlbertsen/ampvis2/blob/HEAD/R/amp_heatmap.R" class="external-link"><code>R/amp_heatmap.R</code></a></small>
    <div class="hidden name"><code>amp_heatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates a heatmap of amplicon data by using sample metadata to aggregate samples and taxonomy to aggregate OTUs.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">amp_heatmap</span><span class="op">(</span>
  <span class="va">data</span>,
  group_by <span class="op">=</span> <span class="cn">NULL</span>,
  facet_by <span class="op">=</span> <span class="cn">NULL</span>,
  normalise <span class="op">=</span> <span class="cn">TRUE</span>,
  tax_aggregate <span class="op">=</span> <span class="st">"Phylum"</span>,
  tax_add <span class="op">=</span> <span class="cn">NULL</span>,
  tax_show <span class="op">=</span> <span class="fl">10</span>,
  showRemainingTaxa <span class="op">=</span> <span class="cn">FALSE</span>,
  tax_class <span class="op">=</span> <span class="cn">NULL</span>,
  tax_empty <span class="op">=</span> <span class="st">"best"</span>,
  order_x_by <span class="op">=</span> <span class="cn">NULL</span>,
  order_y_by <span class="op">=</span> <span class="cn">NULL</span>,
  plot_values <span class="op">=</span> <span class="cn">TRUE</span>,
  plot_values_size <span class="op">=</span> <span class="fl">4</span>,
  plot_legendbreaks <span class="op">=</span> <span class="cn">NULL</span>,
  plot_colorscale <span class="op">=</span> <span class="st">"log10"</span>,
  plot_na <span class="op">=</span> <span class="cn">TRUE</span>,
  measure <span class="op">=</span> <span class="st">"mean"</span>,
  min_abundance <span class="op">=</span> <span class="fl">0.1</span>,
  max_abundance <span class="op">=</span> <span class="cn">NULL</span>,
  sort_by <span class="op">=</span> <span class="cn">NULL</span>,
  normalise_by <span class="op">=</span> <span class="cn">NULL</span>,
  scale_by <span class="op">=</span> <span class="cn">NULL</span>,
  color_vector <span class="op">=</span> <span class="cn">NULL</span>,
  round <span class="op">=</span> <span class="fl">1</span>,
  textmap <span class="op">=</span> <span class="cn">FALSE</span>,
  plot_functions <span class="op">=</span> <span class="cn">FALSE</span>,
  function_data <span class="op">=</span> <span class="cn">NULL</span>,
  functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MiDAS"</span>, <span class="st">"Filamentous"</span>, <span class="st">"AOB"</span>, <span class="st">"NOB"</span>, <span class="st">"PAO"</span>, <span class="st">"GAO"</span><span class="op">)</span>,
  rel_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.25</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>(<em>required</em>) Data list as loaded with <code><a href="amp_load.html">amp_load</a></code>.</p></dd>
<dt>group_by</dt>
<dd><p>(<em>recommended</em>) Group the samples by a categorical variable in the metadata. If <code>NULL</code> then all samples are shown.</p></dd>
<dt>facet_by</dt>
<dd><p>Facet the samples by a categorical variable in the metadata.</p></dd>
<dt>normalise</dt>
<dd><p>(<em>logical</em>) Transform the OTU read counts to be in percent per sample. (<em>default:</em> <code>TRUE</code>)</p></dd>
<dt>tax_aggregate</dt>
<dd><p>The taxonomic level to aggregate the OTUs. (<em>default:</em> <code>"Phylum"</code>)</p></dd>
<dt>tax_add</dt>
<dd><p>Additional taxonomic level(s) to display, e.g. <code>"Phylum"</code>. (<em>default:</em> <code>"none"</code>)</p></dd>
<dt>tax_show</dt>
<dd><p>The number of taxa to show, or a vector of taxa names. (<em>default:</em> <code>10</code>)</p></dd>
<dt>showRemainingTaxa</dt>
<dd><p>Add an additional row at the bottom displaying the sum of all remaining taxa that are not part of the top <code>tax_show</code> most abundant taxa. (<em>default:</em> <code>FALSE</code>)</p></dd>
<dt>tax_class</dt>
<dd><p>Converts a specific phylum to class level instead, e.g. <code>"p__Proteobacteria"</code>.</p></dd>
<dt>tax_empty</dt>
<dd><p>How to show OTUs without taxonomic information. One of the following:</p><ul><li><p><code>"remove"</code>: Remove OTUs without taxonomic information.</p></li>
<li><p><code>"best"</code>: (<em>default</em>) Use the best classification possible.</p></li>
<li><p><code>"OTU"</code>: Display the OTU name.</p></li>
</ul></dd>
<dt>order_x_by</dt>
<dd><p>Reorder the x axis by providing a character vector of the x axis values in the desired order, or <code>"cluster"</code> for hierarchical clustering by <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code>.</p></dd>
<dt>order_y_by</dt>
<dd><p>Reorder the y axis by providing a character vector of the y axis values in the desired order, or <code>"cluster"</code> for hierarchical clustering by <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code>.</p></dd>
<dt>plot_values</dt>
<dd><p>(<em>logical</em>) Plot the values on the heatmap or not. (<em>default:</em> <code>TRUE</code>)</p></dd>
<dt>plot_values_size</dt>
<dd><p>The size of the plotted values. (<em>default:</em> <code>4</code>)</p></dd>
<dt>plot_legendbreaks</dt>
<dd><p>A vector of breaks for the abundance legend, fx <code>c(1, 10, 20)</code>.</p></dd>
<dt>plot_colorscale</dt>
<dd><p>The type of scale used for the coloring of abundances, either <code>"sqrt"</code> or <code>"log10"</code>. (<em>default:</em> <code>"log10"</code>)</p></dd>
<dt>plot_na</dt>
<dd><p>(<em>logical</em>) Whether to color missing values with the lowest color in the scale or not. (<em>default:</em> <code>TRUE</code>)</p></dd>
<dt>measure</dt>
<dd><p>Calculate and display either <code>"mean"</code>, <code>"max"</code> or <code>"median"</code> across the groups. (<em>default:</em> <code>"mean"</code>)</p></dd>
<dt>min_abundance</dt>
<dd><p>All values below this value are given the same color. (<em>default:</em> <code>0.1</code>)</p></dd>
<dt>max_abundance</dt>
<dd><p>All values above this value are given the same color.</p></dd>
<dt>sort_by</dt>
<dd><p>Sorts the heatmap by the most abundant taxa in a specific sample or group of samples. Provide a sample name or a specific value of the group defined by the <code>"group_by"</code> argument, e.g. <code>"Treatment A"</code>.</p></dd>
<dt>normalise_by</dt>
<dd><p>A variable or a specific sample in the metadata to normalise the counts by.</p></dd>
<dt>scale_by</dt>
<dd><p>Scale the abundances by a variable in the metadata.</p></dd>
<dt>color_vector</dt>
<dd><p>Vector of colors for the colorscale, e.g. <code>c("white", "red")</code>.</p></dd>
<dt>round</dt>
<dd><p>Number of digits to show with the values. (<em>default:</em> <code>1</code>)</p></dd>
<dt>textmap</dt>
<dd><p>(<em>logical</em>) Return a data frame to print as raw text instead of a ggplot2 object. (<em>default:</em> <code>FALSE</code>)</p></dd>
<dt>plot_functions</dt>
<dd><p>Return a 2-column grid plot instead, showing known functional information about the Genus-level OTUs next to the heatmap. By default, this functional information is retrieved directly from <a href="midasfieldguide.org">midasfieldguide.org</a>. When using this feature, make sure that either <code>tax_aggregate</code> or <code>tax_add</code> is set to "Genus" and that Genus is the lowest level in either. (<em>default:</em> <code>FALSE</code>)</p></dd>
<dt>function_data</dt>
<dd><p>If <code>plot_functions</code> is set to <code>TRUE</code>: A data frame with functional information at Genus level. The first column must be the Genus names and any other column(s) can be any property or metabolic function of the individual Genera. If <code>NULL</code> then data will be retrieved directly from <a href="midasfieldguide.org">midasfieldguide.org</a>. (<em>default:</em> <code>NULL</code>)</p></dd>
<dt>functions</dt>
<dd><p>If <code>plot_functions</code> is set to <code>TRUE</code>: A vector with the functions to be displayed (column names in the <code>functions_data</code> data frame). If data is succesfully retrieved from <a href="midasfieldguide.org">midasfieldguide.org</a> then available functions can be listed with <code>colnames(.ampvis2_midasfg_function_data)</code>. (<em>default:</em> <code>c("MiDAS","Filamentous", "AOB", "NOB", "PAO", "GAO")</code>)</p></dd>
<dt>rel_widths</dt>
<dd><p>If <code>plot_functions</code> is set to <code>TRUE</code>: A vector with the relative widths of the heatmap and function grid when <code>plot_functions = TRUE</code>. (<em>default:</em> <code>c(0.75, 0.25)</code>)</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A ggplot2 object, or a list of ggplot2 objects if <code>plot_functions = TRUE</code>. A data frame if <code>textmap = TRUE</code>.</p>
    </div>
    <div id="preserving-relative-abundances-in-a-subset-of-larger-data">
    <h2>Preserving relative abundances in a subset of larger data</h2>
    

<p>By default the raw read counts in the abundance matrix are normalised (transformed to percentages) by some plotting functions automatically (for example <code>amp_heatmap</code>, <code><a href="amp_timeseries.html">amp_timeseries</a></code>, and more). This means that the relative abundances shown will be calculated based on the remaining taxa after the subset, not including the removed taxa, if any. To circumvent this, set <code>normalise = TRUE</code> when subsetting with the <code><a href="amp_subset_taxa.html">amp_subset_taxa</a></code> and <code><a href="amp_subset_samples.html">amp_subset_samples</a></code> functions, and then set <code>normalise = FALSE</code> in the plotting function. This will transform the OTU counts to relative abundances BEFORE the subset, and setting <code>normalise = FALSE</code> will skip the transformation in the plotting function, see the example below.</p>
<div class="sourceCode"><pre><code><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"MiDAS"</span><span class="op">)</span>
<span class="va">subsettedData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/amp_subset_samples.html">amp_subset_samples</a></span><span class="op">(</span><span class="va">MiDAS</span>,
                                    <span class="va">Plant</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Aalborg West"</span>, <span class="st">"Aalborg East"</span><span class="op">)</span>,
                                    normalise <span class="op">=</span> <span class="cn">TRUE</span>
                                    <span class="op">)</span>
<span class="fu"><a href="../reference/amp_heatmap.html">amp_heatmap</a></span><span class="op">(</span><span class="va">subsettedData</span>,
            group_by <span class="op">=</span> <span class="st">"Plant"</span>,
            tax_aggregate <span class="op">=</span> <span class="st">"Phylum"</span>,
            tax_add <span class="op">=</span> <span class="st">"Genus"</span>,
            normalise <span class="op">=</span> <span class="cn">FALSE</span>
            <span class="op">)</span></code></pre></div>

    </div>
    <div id="saving-plot-with-ggsave">
    <h2>Saving plot with <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></code></h2>
    

<p>When <code>plot_functions = TRUE</code> a list of ggplot objects is returned to allow adjusting themes etc. of the individual subplots. The list is of class <code>hmfunplot</code> and a matching print function for the S3 class then stitches together the individual plots using the <a href="https://patchwork.data-imaginist.com/" class="external-link">patchwork</a> package. Therefore to save the plot with <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></code> simply pass on the plot object explicitly and wrap it in print(), see examples. This is not necessary if <code>plot_functions = FALSE</code>, as the returned object is then a regular ggplot object.</p>
    </div>
    <div id="accessing-detailed-raw-data">
    <h2>Accessing detailed raw data</h2>
    

<p>The complete raw data used to generate any ggplot can always be accessed with <code>ggplot2_object$data</code> when the plot is saved as a ggplot2 object. Additionally, a "textmap" version of the generated heatmap can also be generated by setting <code>textmap = TRUE</code> to only extract the raw data as shown on the particular heatmap, see examples.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="amp_load.html">amp_load</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Kasper Skytte Andersen <a href="mailto:ksa@bio.aau.dk">ksa@bio.aau.dk</a></p>
<p>Mads Albertsen <a href="mailto:MadsAlbertsen85@gmail.com">MadsAlbertsen85@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Load example data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"AalborgWWTPs"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Heatmap grouped by WWTP</span></span>
<span class="r-in"><span class="fu">amp_heatmap</span><span class="op">(</span><span class="va">AalborgWWTPs</span>, group_by <span class="op">=</span> <span class="st">"Plant"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="amp_heatmap-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Heatmap of 20 most abundant Genera (by mean) grouped by WWTP, split by Year,</span></span>
<span class="r-in"><span class="co"># values not plotted for visibility, phylum name added, colorscale adjusted manually,</span></span>
<span class="r-in"><span class="co"># and show the sum of remaining taxa not part of the top 20 most abundant taxa</span></span>
<span class="r-in"><span class="fu">amp_heatmap</span><span class="op">(</span><span class="va">AalborgWWTPs</span>,</span>
<span class="r-in">  group_by <span class="op">=</span> <span class="st">"Plant"</span>,</span>
<span class="r-in">  facet_by <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span class="r-in">  plot_values <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">  tax_show <span class="op">=</span> <span class="fl">20</span>,</span>
<span class="r-in">  showRemainingTaxa <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">  tax_aggregate <span class="op">=</span> <span class="st">"Genus"</span>,</span>
<span class="r-in">  tax_add <span class="op">=</span> <span class="st">"Phylum"</span>,</span>
<span class="r-in">  color_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span class="r-in">  plot_colorscale <span class="op">=</span> <span class="st">"sqrt"</span>,</span>
<span class="r-in">  plot_legendbreaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="amp_heatmap-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Heatmap with known functional traits about the Genera shown to the right</span></span>
<span class="r-in"><span class="co"># By default this information is retrieved directly from midasfieldguide.org</span></span>
<span class="r-in"><span class="co"># but you can provide your own with the function_data argument as shown with</span></span>
<span class="r-in"><span class="co"># the textmap further down</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span></span>
<span class="r-in"><span class="va">heatmapwfunctions</span> <span class="op">&lt;-</span> <span class="fu">amp_heatmap</span><span class="op">(</span><span class="va">AalborgWWTPs</span>,</span>
<span class="r-in">  group_by <span class="op">=</span> <span class="st">"Plant"</span>,</span>
<span class="r-in">  tax_aggregate <span class="op">=</span> <span class="st">"Genus"</span>,</span>
<span class="r-in">  plot_functions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">  functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PAO"</span>, <span class="st">"GAO"</span>, <span class="st">"AOB"</span>, <span class="st">"NOB"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">heatmapwfunctions</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "hmfunplot"</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># To save the plot with ggsave() wrap the plot object in print()</span></span>
<span class="r-in"><span class="co"># ggsave("plot.png", print(heatmapwfunctions))</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># A raw text version of the heatmap can be printed or saved as a data frame with textmap = TRUE.</span></span>
<span class="r-in"><span class="va">textmap</span> <span class="op">&lt;-</span> <span class="fu">amp_heatmap</span><span class="op">(</span><span class="va">AalborgWWTPs</span>,</span>
<span class="r-in">  group_by <span class="op">=</span> <span class="st">"Plant"</span>,</span>
<span class="r-in">  tax_aggregate <span class="op">=</span> <span class="st">"Genus"</span>,</span>
<span class="r-in">  plot_functions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">  function_data <span class="op">=</span> <span class="va">midasfunctions_20201201</span>,</span>
<span class="r-in">  functions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PAO"</span>, <span class="st">"GAO"</span>, <span class="st">"AOB"</span>, <span class="st">"NOB"</span><span class="op">)</span>,</span>
<span class="r-in">  textmap <span class="op">=</span> <span class="cn">TRUE</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">textmap</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          Aalborg East Aalborg West  PAO  GAO  AOB  NOB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tetrasphaera                 5.478941     6.842382  POS  NEG  NEG  NEG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trichococcus                 7.098638     3.028602   NT   NT   NT   NT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> uncultured                   5.236024     4.304019 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Candidatus Microthrix        2.769444     6.503052 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rhodoferax                   3.361297     2.403885  NEG   NT   NT   NT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rhodobacter                  1.847766     2.967430   NT   NT   NT   NT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Candidatus Promineofilum     1.317348     3.028949 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dechloromonas                1.220824     2.503898 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Candidatus Defluviifilum     1.824867     1.502981 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Propionicimonas              1.229790     1.726184 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kasper Skytte Andersen, Mads Albertsen, Rasmus Hansen Kirkegaard.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'b0ba3a3eb751685982ccf010113f380a',
    indexName: 'ampvis2',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

