% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/amp_alphadiv.R
\name{amp_alphadiv}
\alias{amp_alphadiv}
\alias{amp_alpha_diversity}
\title{Alpha-diversity analysis}
\usage{
amp_alphadiv(
  data,
  measure = NULL,
  richness = FALSE,
  rarefy = NULL,
  plot = FALSE,
  plot_scatter = FALSE,
  plot_group_by = NULL
)

amp_alpha_diversity(
  data,
  measure = NULL,
  richness = FALSE,
  rarefy = NULL,
  plot = FALSE,
  plot_scatter = FALSE,
  plot_group_by = NULL
)
}
\arguments{
\item{data}{(\emph{required}) Data list as loaded with \code{\link{amp_load}}.}

\item{measure}{Alpha-diversity measure(s) to be included if not all. A vector of one or more of:
\itemize{
  \item \code{"uniqueotus"}
  \item \code{"shannon"}
  \item \code{"simpson"}
  \item \code{"invsimpson"}
}}

\item{richness}{(\emph{logical}) Also calculate sample richness estimates (Chao1 and ACE) as calculated by \code{\link[vegan]{estimateR}}. (\emph{default:} \code{FALSE})}

\item{rarefy}{Rarefy species richness to this value before calculating alpha diversity and/or richness. Passed directly as the \code{sample} argument to \code{\link[vegan]{rrarefy}}. (\emph{default:} \code{NULL})}

\item{plot}{(\emph{logical}) Produce a boxplot instead of a table. (\emph{default:} \code{FALSE})}

\item{plot_scatter}{(\emph{logical}) If \code{TRUE} produce a scatter plot instead of a boxplot. (\emph{default:} \code{FALSE})}

\item{plot_group_by}{Group the samples by a categorical variable in the metadata. If \code{NULL} then all samples are shown in a single group.}
}
\value{
A data frame or a ggplot if \code{plot} is set to TRUE
}
\description{
Calculate alpha-diversity indices for each sample and combines with the metadata.
}
\details{
The alpha-diversity indices are calculated per sample using the vegan function \code{\link[vegan]{diversity}}, where the read abundances are first rarefied using \code{\link[vegan]{rrarefy}} by the size of the \code{rarefy} argument. Refer to the vegan documentation for details about the different indices and how they are calculated. If no measure(s) are chosen, all diversity indices will be returned.
}
\examples{
# Load example data
data("AalborgWWTPs")

# Subsample/rarefy to 20000 reads and then calculate
# Shannon and Simpson alpha-diversity indices
alphadiversityresult <- amp_alphadiv(
  AalborgWWTPs,
  measure = c("shannon", "simpson"),
  rarefy = 20000
)

# Explore the results in the data frame
# View(alphadiversityresult)

# Generate a plot instead
amp_alphadiv(
  AalborgWWTPs,
  measure = c("shannon", "simpson"),
  rarefy = 20000,
  plot = TRUE,
  plot_group_by = "Plant"
)
}
\references{
McMurdie, P.J. & Holmes, S. (2014). Waste not, want not: Why
rarefying microbiome data is inadmissible. \emph{PLoS Comput Biol}
\strong{10(4):} e1003531. DOI:\code{10.1371/journal.pcbi.1003531}
}
\seealso{
\code{\link{amp_load}}
}
\author{
Kasper Skytte Andersen \email{ksa@bio.aau.dk}

Mads Albertsen \email{MadsAlbertsen85@gmail.com}
}
